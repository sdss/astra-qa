---
title: "BOSS"
---


```{python}
#| label: tbl-boss-visits
#| tbl-cap: BOSS visits
from IPython.display import Markdown
from tabulate import tabulate
from astra.models import BossVisitSpectrum
from peewee import fn

table = (
    BossVisitSpectrum.select(
        BossVisitSpectrum.release, 
        BossVisitSpectrum.run2d, 
        BossVisitSpectrum.telescope,
        fn.count(BossVisitSpectrum)
    )
    .group_by(
        BossVisitSpectrum.release, 
        BossVisitSpectrum.run2d,
        BossVisitSpectrum.telescope
    )
    .order_by(
        BossVisitSpectrum.release.desc()
    )
    .tuples()
)

Markdown(tabulate(
    [(*_, f"{c:,}") for *_, c in table], 
    headers=[
        "Release", 
        "DRP",
        "Telescope", 
        "Spectra"
    ]
))
```

